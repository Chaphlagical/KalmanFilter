# 概率与期望

## 一、概率论基础

### （一）概率密度函数

$\int_{\Re^n}p(x)dx=1\ ,p(x)\geq0$

 $P(x\in A)=\int_A p(x)dx$

### （二）累积概率函数

$P(x)\mathop{=}\limits^{def}\int_{-\infty}^xdp(x)$

### （三）期望值和概率密度

期望算子$\mathop{E}\limits_{x\in X}\langle\cdot\rangle$  定义为：$\mathop{E}_x\langle f(x)\rangle\mathop{=}\limits^{def}\int f(x)p(x)dx$

### （四）概率分布的矩

#### 1、原点矩

对于标量变量：

$^{[N]}\mu_x=\mathop{E}\limits_x\langle x^N \rangle$

零阶矩总是存在的：$^{[0]}\mu_x\mathop{=}\limits^{def}\mathop{E}\limits_x\langle x^0\rangle=\mathop{E}\limits_x \langle 1\rangle=\int p_x(x)dx$

#### 2、均值

随机变量$X$的一阶矩称为$X$的分布均值：

$^{[1]}\mu_x\mathop{=}\limits^{def}\mathop{E}\limits_x\langle x\rangle\mathop{=}\limits^{def}\begin{bmatrix}\mathop{E}\limits_x\langle x_1\rangle \\ \mathop{E}\limits_x\langle x_2\rangle \\ \mathop{E}\limits_x\langle x_3\rangle\\ \vdots \\ \mathop{E}\limits_x\langle x_n\rangle\end{bmatrix}$ 

#### 3、中心矩

对于标量变量：

$^{[N]}\sigma_x\mathop{=}\limits^{def}E_x\langle(x-^{[1]}\mu_x)^N\rangle$

#### 4、协方差矩阵

n维向量

$\begin{align*}P_{xx}&=^{[2]}\sigma_x\\&=\mathop{E}\limits_x\langle(x-^{[1]}\mu_x)(x-^{[1]}\mu_x)^T\rangle\\&=\begin{bmatrix}p_{11}&p_{12}&p_{13}&\cdots&p_{1n}\\p_{21}&p_{22}&p_{23}&\cdots&p_{2n}\\p_{31}&p_{32}&p_{33}&\cdots&p_{3n}\\\vdots&\vdots&\vdots&\ddots&\vdots\\p_{n1}&p_{n2}&p_{n3}&\cdots&p_{nn} \end{bmatrix}\end{align*}$

$p_{ij}\mathop{=}\limits^{def}E_x\langle(x_i-^{[1]}\mu_{x\ i})(x_j-^{[1]}\mu_{x\ j})\rangle$

#### 5、互协方差

$p_{ij}=\mathop{E}\limits_x\langle(x_i-\mu_j)(x_j-\mu_j)\rangle$表示$X$的第$i$个分量和第$j$个分量之间的互协方差。

一般的，如果$X_a$和$X_b$表示向量变量$X$的非重叠子向量，则$P_{xx}$的子矩阵$P_{ab}=\mathop{E}\limits_x\langle x_ax_b^T\rangle$ 表示$X_a$和$X_b$的互协方差。

将随机向量$X$分割为下列子向量：

$x=\begin{bmatrix}X_a\\X_b\end{bmatrix}$

则相应的协方差矩阵可以分割为：

$P_{xx}=\begin{bmatrix}P_{x_ax_a}&P_{x_ax_b}\\P_{x_bx_a}&P_{x_bx_b} \end{bmatrix}$

一般情况下，有$P_{x_ax_b}=P^T{x_bx_a}$

#### 6、相关系数

对于协方差矩阵$P_{xx}$中位于第$i$行第$j$列的任意项$p_{ij}$，比值

$\rho_{ij}\mathop{=}\limits^{def}\frac{p_{ij}}{\sqrt{p_{ii}p_{ij}}}$

性质：

* 对于所有的$i$，都有$\rho_{ii}=1$
* $\rho_{ij}=\rho_{ji}$
* 对于所有的$i$和$j$，都有$-1\leq\rho_{ij}\leq1$

对于协方差矩阵$P_{xx}$，如果给定$\rho_{ij}$的值，则可以被分解为以下矩阵乘积：

$P_{xx}=diag(\sigma)C_{\rho}diag(\sigma)$

$diag(\sigma)\mathop{=}\limits^{def}\begin{bmatrix}\sigma_1&0&0&\cdots&0\\0&\sigma_2&0&\cdots&0\\0&0&\sigma_3&\cdots&0\\\vdots&\vdots&\vdots&\ddots&\vdots\\0&0&0&\cdots&\sigma_n \end{bmatrix}$

$\sigma_i\mathop{=}\limits^{def}\sqrt{p_{ii}}\ ,i=1,2,3,\cdots,n$

$C_{\rho}\mathop{=}\limits^{def}\begin{bmatrix}1&\rho_{12}&\rho_{13}&\cdots&\rho_{1n}\\\rho_{21}&1&\rho_{23}&\cdots&\rho_{2n}\\\rho_{31}&\rho_{32}&1&\cdots&\rho_{3n}\\\vdots&\vdots&\vdots&\ddots&\vdots\\\rho_{n1}&\rho_{n2}&\rho_{n3}&\cdots&1 \end{bmatrix}$

## 二、最小均方估计（LMSE）

### （一）平方估计误差

$\varepsilon=|\hat{x}-x|^2$

### （二）最小化

$\begin{align*}\varepsilon^2(\hat{x})&=\mathop{E}\limits_x\langle|\hat{x}-x|^2\rangle\\&=\mathop{E}\limits_x\langle(\hat{x}-x)^T(\hat{x}-x)\rangle\\&=\mathop{E}\limits_x\langle\hat{x}^T\hat{x}-2\hat{x}^Tx+\hat{x}^Tx\rangle\\&=\mathop{E}\limits_x\langle\hat{x}^Tx\rangle-2\mathop{E}\limits_x\langle\hat{x}^Tx\rangle+\mathop{E}\limits_x\langle x^Tx\rangle\\&=\mathop{E}\limits_x\langle\sum\limits_j\hat{x}_j^2\rangle-2\mathop{E}\limits_x\langle\sum\limits_j\hat{x}_jx_j\rangle+\mathop{E}\limits_x\langle\sum\limits_jx_j^2\rangle\\&=|\hat{x} |^2-2\hat{x}\mathop{E}\limits_x\langle x\rangle+\mathop{E}\limits_x\langle |x|^2\rangle \end{align*}$

令$\frac{\partial\varepsilon^2(\hat{x})}{\partial \hat{x}}=2\hat{x}-2\mathop{E}\limits_x\langle x \rangle=0$

可得误差最小值处$x_{LMSE}=\mathop{E}\limits_x\langle x\rangle$ 

### （三）最小均方估计误差

最小协方估计误差的协方差是概率分布的二阶中心矩：

$\mathop{E}\limits_x\langle(\hat{x}_{LMSE}-x)(\hat{x}_{LMSE}-x)^T\rangle=P_{xx}$

平方估计误差式在$\hat{x}=\mu$处的值为：

$\begin{align*}\varepsilon^2(\mu)&=\sum\limits_j\mathop{E}\limits_x\langle(x-\mu)\rangle\\&= \sum\limits_jp_{ij}\\&=tr(P_{xx})\end{align*}$

